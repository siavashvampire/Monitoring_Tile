<div class="content">
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-header card-header-info card-header-icon pointer"  data-toggle="collapse" data-target="#searchUsers" aria-expanded="false" aria-controls="searchUsers">
                        <div class="card-icon" >
                            <i class="material-icons">search</i>
                        </div>
                        <h4 class="card-title float-{$float} m-3">جستجو</h4>
                    </div>
                    <div class="collapse" id="searchUsers">
                        <div class="card-body">
                            {set loadDivID,"#listToGetFromServer"}
                            {set loadDivIDInHtml,"listToGetFromServer"}
                            <form class="form-horizontal" id="listToGetFromServerForm" onsubmit="return search('{url current}' ,'{$loadDivID}');">
                                <div class="row">
                                    <div class="col-md-4">
                                        <label class="col-md-3 col-form-label">نام کاشی</label>
                                        <div class="col-md-9">
                                           <div class="form-group has-default">
                                               <input type="text" name="name" autocomplete="off" class="form-control">
                                           </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <label class="col-md-3 col-form-label">طول - cm</label>
                                        <div class="col-md-9">
                                           <div class="form-group has-default">
                                               <input type="text" name="width" autocomplete="off" class="form-control">
                                           </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <label class="col-md-3 col-form-label">عرض - cm</label>
                                        <div class="col-md-9">
                                           <div class="form-group has-default">
                                               <input type="text" name="length" autocomplete="off" class="form-control">
                                           </div>
                                        </div>
                                    </div>
                                   <div class="col-md-12">
                                       <button class="btn btn-link" id="closeSearch" data-toggle="collapse" data-target="#searchUsers" aria-expanded="false" aria-controls="searchUsers">{_ "close"}</button>
                                       <button type="submit" class="btn btn-fill btn-info">{_ "search"}</button>
                                   </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-12">
                <div class="card" id="listToGetFromServer">
                    <div class="card-header card-header-info card-header-icon">
                        <div class="card-icon">
                            <i class="fa fa-delicious fa-2x"></i>
                        </div>
                        <h4 class="card-title float-{$float} m-3">لیست کاشی ها</h4>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table text-{$text_align}" id="tebleExport">
                                <thead>
                                <tr>
                                    <th style="width: 32%">نام کاشی</th>
                                    <th style="width: 32%">طول</th>
                                    <th style="width: 32%">عرض</th>
                                    <th style="width: 4%"></th>
                                </tr>
                                </thead>
                                <tbody>
                                {foreach from=$tiles key=key value=tile}
                                <tr>
                                    <td >{$tile.label}</td>
                                    <td >{$tile.tile_width}cm</td>
                                    <td >{$tile.tile_length}cm</td>
                                    <td ><button class="btn btn-link text-info" onclick="openTileEditor('{$tile.id}','{$tile.label}','{$tile.tile_length}','{$tile.tile_width}')"><i class="fa fa-pencil"></i></button> </td>
                                </tr>
                                {foreachelse}
                                <tr>
                                    <td class="text-center" colspan="4">{_ "hasNotDataYet"}</td>
                                </tr>
                                {/foreach}
                                </tbody>
                            </table>
                        </div>
                        {view "[url patch]pagination.mold.html"}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel"></h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="alert alert-success text-right" id="dataSendAlert">
                    تغییرات با موفقیت انجام شد.
                </div>
                <form>
                    <div class="form-group">
                        <label for="label" class="col-form-label float-right">نام کاشی:</label>
                        <input type="text" class="form-control" id="label" value="">
                        <input type="hidden" class="form-control" id="id" value="">
                    </div>
                    <div class="form-group">
                        <label for="tile_width" class="col-form-label float-right">طول - cm:</label>
                        <input class="form-control" id="tile_width" value="">
                    </div>
                    <div class="form-group">
                        <label for="tile_length" class="col-form-label float-right">عرض - cm:</label>
                        <input class="form-control" id="tile_length" value="">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-warning float-left" data-dismiss="modal" style="position: absolute;">بستن</button>
                <button type="button" class="btn btn-success float-right" id="sendDataButton" onclick="sendTile();" >ارسال</button>
            </div>
        </div>
    </div>
</div>


{map navBarButton}
<button class="btn btn-info"  onclick="openTileEditor('','','','')">
                      <span class="btn-label">
                        <i class="fa fa-plus"></i>
                      </span>
    اضافه کردن کاشی جدید
</button>
{/map}

{map footerjs}
<script>
var urlc = '{url current}' ;
var div = '{$loadDivID}' ;
function openTileEditor(id,name,lenght,width){
    if ( id === "" ){
        $("#exampleModalLabel").html("اضافه کردن کاشی جدید");
        $("#label").val("");
        $("#id").val("");
        $("#tile_length").val("");
        $("#tile_width").val("");
    } else {
        $("#exampleModalLabel").html("ویرایش نوع کاشی");
        $("#label").val(name);
        $("#id").val(id);
        $("#tile_length").val(lenght);
        $("#tile_width").val(width);
    }
    $('.bmd-label-static').removeClass('bmd-label-static');
    $('#sendDataButton').show();
    $('#dataSendAlert').hide();
    $('#exampleModal').modal('show');
}
function sendTile(){
    $.ajax({
        url: urlc+'/update',
        type: 'post',
        dataType: 'json',
        data: {
            'label': $('#label').val(),
            'id': $('#id').val(),
            'tile_length': $('#tile_length').val(),
            'tile_width': $('#tile_width').val()
        } ,
        success: function (result) {
            if (result['status']) {
                $("#dataSendAlert").removeClass("alert-danger").addClass("alert-success").html("تغییرات با موفقیت انجام شد.").show();
                $('#sendDataButton').hide();
                load();
                return false;
            }
            else {
                $("#dataSendAlert").addClass("alert-danger").removeClass("alert-success").html(result['message']).show();
            }
        }
    });
}
</script>
{/map}