<div class="content">
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-header card-header-info card-header-icon pointer"  data-toggle="collapse" data-target="#searchUsers" aria-expanded="false" aria-controls="searchUsers">
                        <div class="card-icon" >
                            <i class="material-icons">search</i>
                        </div>
                        <h4 class="card-title float-{$float} m-3">{_ "searchIn"} {_ "Poll"}</h4>
                    </div>
                    <div class="collapse" id="searchUsers">
                        <div class="card-body">
                            {set loadDivID,"#listToGetFromServer"}
                            {set loadDivIDInHtml,"listToGetFromServer"}
                            <form class="form-horizontal" id="listToGetFromServerForm" onsubmit="return search('{url current}' ,'{$loadDivID}');">
                                <div class="row">
                                    <div class="col-md-6">
                                        <label class="col-md-3 col-form-label">{_ "date"} {_ "send"}</label>
                                        <div class="col-md-9">
                                            <div class="form-group has-default">
                                                <input type="text" autocomplete="off" class="form-control persianJustDatepicker-from">
                                                <input type="hidden" name="voteSendFrom" class="form-control persianJustDatepicker-from-alt">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="col-md-3 col-form-label">{_ "until"}</label>
                                        <div class="col-md-9">
                                            <div class="form-group has-default">
                                                <input type="text" autocomplete="off" class="form-control persianJustDatepicker-to">
                                                <input type="hidden" name="voteSendUntil" class="form-control persianJustDatepicker-to-alt">
                                            </div>
                                        </div>
                                    </div>
                                </div><div class="row">
                                <div class="col-md-6">
                                    <label class="col-md-3 col-form-label">{_ "date"} {_ "Complete"}</label>
                                    <div class="col-md-9">
                                        <div class="form-group has-default">
                                            <input type="text" autocomplete="off" class="form-control persianJustDatepicker-from2">
                                            <input type="hidden" name="voteCompletedFrom" class="form-control persianJustDatepicker-from-alt2">
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <label class="col-md-3 col-form-label">{_ "until"}</label>
                                    <div class="col-md-9">
                                        <div class="form-group has-default">
                                            <input type="text" autocomplete="off" class="form-control persianJustDatepicker-to2">
                                            <input type="hidden" name="voteCompletedUntil" class="form-control persianJustDatepicker-to-alt2">
                                        </div>
                                    </div>
                                </div>
                                </div><div class="row">
                                    <div class="col-md-4">
                                        <label class="col-md-3 col-form-label">{_ "title"} {_ "form"}</label>
                                        <div class="col-md-9">
                                            <div class="form-group has-default">
                                                <select class="selectpicker" multiple data-live-search="true" name="votesIds[]"  data-size="7" data-style="btn btn-outline-info btn-round text-{$float}" title="{_ "title"} {_ "form"}">
                                                    {math format="x" x=""  set="tempMint"}
                                                    {foreach from=$access key=key value=access_item }
                                                        {if $tempMint != $access_item.name }
                                                        </optgroup>
                                                        <optgroup label="{$access_item.name}">
                                                        {math format="x" x=$access_item.name  set="tempMint"}
                                                        {/if}
                                                        <option value="{$access_item.voteId}" >{$access_item.voteName}</option>
                                                    {/foreach}
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <label class="col-md-3 col-form-label">{_ "status"}</label>
                                        <div class="col-md-9">
                                            <div class="form-group has-default">
                                                <select class="selectpicker" name="status" data-size="7" data-style="btn btn-outline-info btn-round text-{$float}" title="{_ 'status'}">
                                                    <option value="all" selected  >{_ "all"}</option>
                                                    <option value="1" >{_ "Completed"}</option>
                                                    <option value="0" >{_ "NotCompleted"}</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4 mt-1 float-left">
                                        <button class="btn btn-link float-left" id="closeSearch" data-toggle="collapse" data-target="#searchUsers" aria-expanded="false" aria-controls="searchUsers">{_ "close"}</button>
                                        <button type="submit" class="btn btn-fill btn-info float-left">{_ "search"}</button>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-12">
                <div class="card" id="listToGetFromServer">
                    <div class="card-header card-header-info card-header-icon">
                        <div class="card-icon">
                            <i class="fa fa-file-text-o"></i>
                        </div>
                        <h4 class="card-title float-{$float} m-3">{_ "Poll"} {_ "contracts"}</h4>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table text-{$text_align}">
                                <thead>
                                <tr>
                                    <th style="width: 12%">{_ "title"} {_ "form"}</th>
                                    <th style="width: 15%">{_ "time"} {_ "Creation"} {_ "form"}</th>
                                    <th style="width: 15%">{_ "Complementary"}</th>
                                    <th style="width: 15%">{_ "unit"} {_ "Complementary"}</th>
                                    <th style="width: 15%">{_ "time"} {_ "Complete"} {_ "form"}</th>
                                    <th style="width: 20%"></th>
                                </tr>
                                </thead>
                                <tbody>
                                {foreach from=$contracts key=key value=contract}
                                <tr>
                                    <td>{$contract.voteName}</td>
                                    <td>{$contract.creatDate|jDate:"j F Y - H&#58;i&#58;s"}</td>
                                    <td><a href="{url admin}users/profile/{$contract.userId}" target="_blank">{$contract.fname} {$contract.lname}</a></td>
                                    <td>{$contract.name}</td>
                                    <td>{if $contract.status}{$contract.fillOutDate|jDate:"j F Y - H&#58;i&#58;s"}{else}{_ "NotCompleted"}{/if}</td>
                                    <td class="td-actions text-right">
                                        <button class="btn btn-link text-info mr-2" onclick="openContractVote('{$contract.fillOutId}')"><i class="fa fa-eye"></i></button>
                                        <button class="btn btn-link text-info mr-2" onclick="openContractView('{$contract.contactUserId}','{$contract.contractId}')"><i class="fa fa-file-text"></i></button>
                                        <button class="btn btn-link text-info mr-2" onclick="openContractViewForVote('{$contract.contactUserId}','{$contract.contractId}')"><i class="fa fa-check-square-o"></i></button>
                                    </td>
                                </tr>
                                {foreachelse}
                                <tr>
                                    <td class="text-center" colspan="6">{_ "hasNotDataYet"}</td>
                                </tr>
                                {/foreach}
                                </tbody>
                            </table>
                        </div>
                        {view "[url patch]pagination.mold.html"}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog  modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel"></h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body" id="contractContent">
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="exampleModal2" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog  modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body" id="voteContent">
            </div>
        </div>
    </div>
</div>


{map footerjs}
<script>
    var urlc = '{url current}' ;
    var urlAdmin = "{url 'admin'}" ;
    var urlTheme= "{url themeBase}" ;
    var div = '{$loadDivID}' ;
    function openContractView(userId,id){
        ajaxRunUrlHtml(urlAdmin+'contractAction/'+userId+'/'+id, '#contractContent' , 'openModule');
    }
    function openContractViewForVote(userId,id){
        ajaxRunUrlHtml(urlAdmin+'contractAction/'+userId+'/'+id+'?voteShow=1', '#contractContent' , 'openModule');
    }
    function openContractVote(id){
        ajaxRunUrlHtml(urlAdmin+'contractAction/showFillVote/'+id, '#voteContent' , 'openModule2');
    }
    function  openModule() {
        $('#exampleModal').modal('show');
        $('#exampleModal2').modal('hide');
    }
    function  openModule2() {
        $('#exampleModal2').modal('show');
    }
    function printDiv(divName) {
        var divToPrint=document.getElementById(divName);
        var newWin=window.open('','Print-Window');
        newWin.document.open();
        newWin.document.write('<html><meta charset="utf-8" /><meta http-equiv="content-type" content="text/plain; charset=UTF-8"/>' +
            '<link href="'+urlTheme+'assets/ajax/libs/bootstrap-rtl/3.4.0/css/bootstrap-rtl.css" rel="stylesheet">\n' +
            '<link href="'+urlTheme+'assets/css/material-dashboard.minf066.css?v=2.1.0" rel="stylesheet" />' +
            '<body onload="window.print()" class="rtl text-right">'+divToPrint.innerHTML+'</body></html>');
        //newWin.document.close();
        //setTimeout(function(){newWin.close();},10);
    }
</script>
{/map}