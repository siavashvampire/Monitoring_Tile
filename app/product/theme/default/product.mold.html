<div class="content">
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-header card-header-info card-header-icon">
                        <div class="card-icon" >
                            <i class="fa fa-file-excel-o fa-2x"></i>
                        </div>
                        <h4 class="card-title float-{$float} m-3">{_ "configuration"} {$item_label}</h4>
                    </div>        
                    <div class="card-body">
                        <form class="form-horizontal" method="post">
                            <div class="row">
                                <div class="col-md-4 float-right form-group">
                                    <label for="label" class="col-form-label col-md-3 float-right">{_ "name"} {_ "design"}:<span class="text-danger">*</span></label>
                                    <div class="col-md-9">
                                        <div class="form-group has-default">
                                            <input type="text" class="form-control " required  id="label" name="label" value="{if isset($Mold.post.label)}{$Mold.post.label}{elseif isset($model)}{$model->getLabel()}{/if}">
                                        </div>
                                    </div>
                                </div>

                                <div class="col-md-4 form-group">
                                    <label for="tile_kind" class="col-form-label col-md-3 float-right">{_ "color"}:<span class="text-danger">*</span></label>
                                    <div class="col-md-9">
                                        <div class="form-group has-default">
                                            <select class="selectpicker selectpickerNotRefresh selectPickerShouldRefresh" required id="color" name="color" data-live-search="true" data-size="7" data-style="btn btn-outline-info btn-round text-{$float}" title="{_ "color"}:">
                                                {foreach from=$colors key=key value=color }
                                                <option value="{$color.id}" {if isset($Mold.post.color)}{if $color.id == $Mold.post.color }selected{/if}{elseif isset($model) and $color.id == $model->getColor()}selected{/if} >{$color.label}</option>
                                                {/foreach}
                                            </select>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-md-4 form-group">
                                    <label for="showSort" class="col-form-label col-md-3 float-right">شماره رده بندی:<span class="text-danger">*</span></label>
                                    <div class="col-md-9">
                                        <div class="form-group has-default">
                                            <input type="number" min="0" class="form-control" required id="showSort" name="showSort" value="{if isset($Mold.post.showSort)}{$Mold.post.showSort}{elseif isset($VSensor)}{$VSensor->getshowSort()}{/if}">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-12 text-center mt-2">
                                    <div class="form-check">
                                        <label class="form-check-label">
                                            <input autocomplete="off"  class="form-check-input" id="Export" name="Export" type="checkbox" {if isset($Mold.post.Export)}{if $Mold.post.Export == 1 }checked{/if}{else}{if isset($VSensor)}{if $VSensor->getExport()}checked{/if}{else}checked{/if}{/if} value="1">گزارش
                                            <span class="form-check-sign">
                                                <span class="check"></span>
                                            </span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            
                            <hr>
                            
                            <div class="row">
                                <div class="col-md-6  form-group" id="tile_kindParentDiv">
                                    <label for="tile_kind" class="col-form-label col-md-3 float-right">نوع کاشی:<span class="text-danger">*</span></label>
                                    <div class="col-md-9">
                                        <div class="form-group has-default">
                                            <select class="selectpicker selectpickerNotRefresh selectPickerShouldRefresh" required id="tile_kind" name="tile_kind" data-live-search="true" data-size="7" data-style="btn btn-outline-info btn-round text-{$float}" title="نوع کاشی">
                                            {foreach from=$tiles key=key value=access_item }
                                            <option value="{$access_item.id}" {if isset($Mold.post.tile_kind)}{if $access_item.id == $Mold.post.tile_kind }selected{/if}{elseif isset($VSensor) and $access_item.id == $VSensor->getId()}selected{/if} >{$access_item.label}</option>
                                            {/foreach}
                                            </select>
                                        </div>
                                    </div>
                                </div>                                
                                <div class="col-md-6 form-group"   id="tile_degreeParentDiv">
                                <label for="tile_degree" class="col-form-label col-md-3 float-right">درجه کاشی:<span class="text-danger">*</span></label>
                                <div class="col-md-9">
                                    <div class="form-group has-default">
                                <select class="selectpicker selectpickerNotRefresh selectPickerShouldRefresh" required id="tile_degree" name="tile_degree" data-live-search="true" data-size="7" data-style="btn btn-outline-info btn-round text-{$float}" title="نوع کاشی">
                                    <option value="همه" {if isset($Mold.post.tile_degree)}{if "همه" == $Mold.post.tile_degree }selected{/if}{elseif isset($VSensor)} {if "همه" == $VSensor->getTileDegree()}selected{/if}{else}selected{/if} >کلی</option>
                                    <option value="درجه 1" {if isset($Mold.post.tile_degree)}{if "درجه 1" == $Mold.post.tile_degree }selected{/if}{elseif isset($VSensor) and "درجه 1" == $VSensor->getTileDegree()}selected{/if} >درجه 1</option>
                                    <option value="درجه 2" {if isset($Mold.post.tile_degree)}{if "درجه 2" == $Mold.post.tile_degree }selected{/if}{elseif isset($VSensor) and "درجه 2" == $VSensor->getTileDegree()}selected{/if}  >درجه 2</option>
                                    <option value="درجه 3" {if isset($Mold.post.tile_degree)}{if "درجه 3" == $Mold.post.tile_degree }selected{/if}{elseif isset($VSensor) and "درجه 3" == $VSensor->getTileDegree()}selected{/if}  >درجه 3</option>
                                    <option value="درجه U" {if isset($Mold.post.tile_degree)}{if "درجه U" == $Mold.post.tile_degree }selected{/if}{elseif isset($VSensor) and "درجه U" == $VSensor->getTileDegree()}selected{/if}  >درجه U</option>
                                    <option value="درجه W" {if isset($Mold.post.tile_degree)}{if "درجه W" == $Mold.post.tile_degree }selected{/if}{elseif isset($VSensor) and "درجه W" == $VSensor->getTileDegree()}selected{/if}  >درجه W</option>
                                </select>
                                        </div>
                                    </div>
                            </div>

                            </div>
                            <hr>
                            <div class="row">
                                <div class="col-md-6 form-group"  id="fazDiv">
                                <label for="faz" class="col-form-label col-md-3 float-right">فاز:<span class="text-danger">*</span></label>
                                    <div class="col-md-9">
                                    <div class="form-group has-default">
                                <select class="selectpicker selectpickerNotRefresh selectPickerShouldRefresh" required id="faz" name="faz" data-live-search="true" data-size="7" data-style="btn btn-outline-info btn-round text-{$float}" title="فاز">
                                    {foreach from=$phases key=key value=phase }
                                            <option value="{$phase.id}" {if isset($Mold.post.faz)}{if $phase.id == $Mold.post.faz }selected{/if}{elseif isset($VSensor) and $phase.id == $VSensor->getPhase()}selected{/if} >{$phase.label}</option>
                                    {/foreach}
                                </select>
                                    </div>
                                    </div>
                                </div>
                                
                                <div class="col-md-6  form-group" id="unitDiv">
                                <label for="unitId" class="col-form-label col-md-3 float-right">واحد:<span class="text-danger">*</span></label>
                                    <div class="col-md-9">
                                    <div class="form-group has-default">
                                <select class="selectpicker selectpickerNotRefresh selectPickerShouldRefresh" id="unitId" name="unitId" data-live-search="true" data-size="7" data-style="btn btn-outline-info btn-round text-{$float}" title="واحد">
                                    {foreach from=$units key=key value=unit }
                                        <option value="{$unit.id}"  {if isset($Mold.post.unitId)}{if $unit.id == $Mold.post.unitId }selected{/if}{elseif isset($VSensor) and $unit.unitId == $VSensor->getUnit()}selected{/if}>{$unit.label}</option>
                                    {/foreach}
                                </select>
                                </div> 
                                </div> 
                                </div> 
                            </div>
                            
                            <hr>
                            <div class="row">
                                <div class="col-md-12">
                                    <table class="table text-right">
                                        <thead>
                                            <tr>
                                                <th style="width: 50%">نام سنسور</th>
                                                <th style="width: 10%">علامت</th>
                                                <th style="width: 40%">
                                                    <button type="button" class="btn btn-info" onclick="$('#bodySensor').append(oneRowSensor);refreshPageJs();">
                                                        <i class="fa fa-plus-circle"></i>
                                افزودن سنسور جدید                                        </button>
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody id="bodySensor" >
                                            <tr style="display:none" id="bodySensorElemnt">
                                                <td>
                                                    <select class="selectpicker" name="SensorChosenId[]" data-size="7" data-style="btn btn-outline-info btn-round text-{$float}" title="نام سنسور">
                                                    {foreach from=$Sensors key=key value=Sensor }
                                                     <option value="{$Sensor.Sensor_id}" >{$Sensor.label}</option>
                                                    {/foreach}
                                                    </select>
                                                </td>
                                                <td>
                                                    <select class="selectpicker" name="SensorSign[]" data-size="7" data-style="btn btn-outline-info btn-round text-{$float}" title="علامت سنسور">
                                                        <option value = "1" > +1 </option>
                                                        <option value = "-1"> -1 </option>
                                                    </select>
                                                </td>
                                                <td style="transform: translate(0%, 0%);" class="td-actions">
                                                    <button type="button" class="btn btn-danger p-2 ml-3" onclick="$(this).parent().parent().remove();">
                                                        <i class="fa fa-trash"></i>
                                                        حذف                                        </button>
                                                </td>
                                            </tr>
                                            {if isset($Mold.post.SensorChosenId )}
                                                {foreach from=$Mold.post.SensorChosenId key=key and value=Sensor}
                                                    <tr>
                                                        <td>
                                                            <select class="selectpicker" name="SensorChosenId[]" data-size="7" data-style="btn btn-outline-info btn-round text-{$float}" title="نام سنسور">
                                                            {foreach from=$Sensors key=key2 value=Sensor2 }
                                                                <option value="{$Sensor2.Sensor_id}" {if $Mold.post.SensorChosenId.[$key] == $Sensor2.Sensor_id } selected {/if}>{$Sensor2.label}</option>
                                                            {/foreach}
                                                            </select>
                                                        </td>
                                                        <td>
                                                            <select class="selectpicker" name="SensorSign[]" data-size="7" data-style="btn btn-outline-info btn-round text-{$float}" title="علامت سنسور">
                                                                <option value = "1" {if $Mold.post.SensorSign.[$key] == "1" } selected {/if}> +1 </option>
                                                                <option value = "-1"{if $Mold.post.SensorSign.[$key] == "-1"} selected {/if}> -1 </option>
                                                            </select>
                                                        </td>
                                                        <td style="transform: translate(0%, 0%);" class="td-actions">
                                                            <button type="button" class="btn btn-danger p-2 ml-3" onclick="$(this).parent().parent().remove();">
                                                                <i class="fa fa-trash"></i>
                                                                حذف                                        </button>
                                                        </td>
                                                    </tr>
                                                {/foreach}
                                            {elseif isset($VSensor) }
                                                {set 'numbersof' ,$VSensor ->getSensorSign()}
                                                {set 'numbersofV',$VSensor ->getSensorChosenId()}
                                                {foreach from=$VSensor->getSensorChosenId() key=key and value=Sensor}
                                                    <tr>
                                                        <td>
                                                            <select class="selectpicker" name="SensorChosenId[]" data-size="7" data-style="btn btn-outline-info btn-round text-{$float}" title="نام سنسور">
                                                            {foreach from=$Sensors key=key2 value=Sensor2 }
                                                                <option value="{$Sensor2.Sensor_id}" {if $numbersofV.[$key] == $Sensor2.Sensor_id } selected {/if} >{$Sensor2.label}</option>
                                                            {/foreach}
                                                            </select>
                                                        </td>
                                                        <td>
                                                            <select class="selectpicker" name="SensorSign[]" data-size="7" data-style="btn btn-outline-info btn-round text-{$float}" title="علامت سنسور">
                                                                <option value = "1" {if $numbersof.[$key] == "1" } selected {/if}> +1 </option>
                                                                <option value = "-1"{if $numbersof.[$key] == "-1"} selected {/if}> -1 </option>
                                                            </select>
                                                        </td>
                                                        <td style="transform: translate(0%, 0%);" class="td-actions">
                                                            <button type="button" class="btn btn-danger p-2 ml-3" onclick="$(this).parent().parent().remove();">
                                                                <i class="fa fa-trash"></i>
                                                                حذف                                        </button>
                                                        </td>
                                                    </tr>
                                                {/foreach}
                                            {/if}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <hr>
                            <div class="row">
                               <div class="col-md-12">
                                   <button type="submit" class="btn btn-fill btn-info"><i class="fa fa-download"></i> ثبت سنسور دخیره ساز</button>
                               </div>
                            </div>
                        </form>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>

{map footerjs}
<script>
    var urlc = '{url current}' ;
    var oneRowSensor ='<tr>'+ $('#bodySensorElemnt').html()+"</tr>";
    $('#bodySensorElemnt').remove();
    function  refreshPageJs() {
    $('.selectpicker:not(.selectpickerNotRefresh)').selectpicker('refresh');
}
</script>
{/map}
{map navBarButton}
<a class="btn btn-info"  href="{url admin}storageSensor/List">
                      <span class="btn-label">
                        <i class="fa fa-plus"></i>
                      </span>
    برگشت به لیست سنسورهای دخیره ساز
</a>
{/map}